{"title":"阿里云Linux-Ubuntu折腾记","slug":"start-linux-on-aliyun","date":"2016-02-20T08:25:34.000Z","updated":"2016-11-12T19:27:58.353Z","comments":true,"path":"api/articles/start-linux-on-aliyun.json","excerpt":"<p>观望阿里云很久了，终于在这个春节来了后，一咬牙、一狠心、一跺脚就买下了一台 ECS。不分昼夜的折腾了几天后，终于在几天前配置好了自己期望的使用环境。<br>由于本人初次接触 Linux，配置期间三度初始化磁盘（等价于手机恢复出厂设置），可以说是一步一个坑的走下来的。现趁热打铁对最后一次正确的安装配置做一下总结，给后人乘凉吧。</p><h2 id=\"选择配置\"><a href=\"#选择配置\" class=\"headerlink\" title=\"选择配置\"></a>选择配置</h2><p>作为开发者，选择 Linux 是毋庸置疑的。</p><p>CPU 单核2G，对于我目前来说绝对是够用了。我会用来做什么？当然是瞎折腾了！一台远程服务器就相当于你多了一台24小时不关机的电脑，可以挂点有趣的服务跑着，比如爬虫之类。或者当个代码仓库，用来项目演示。当然，博客也肯定会迁过去的。<br>带宽 2G，不知道带宽提升是不是会影响远程桌面速度。<br>对于 Linux 的诸多版本之间的优劣，我也不甚了解，就选了个耳濡目染较多的 Ubuntu，版本自然是选最新版的64位。<br>Linux 自带 20G 系统盘，另外我又加了一块 100G 云盘，感觉现在还用不了这么大空间。</p><p>以上配置一年的价格是 1200+，我选择的地域是青岛，比国内其他地域相对便宜点。另外付款的时候填写推荐码可以优惠 10%，这是我的推荐码：<strong>rg2j5m</strong>。当然你使用我的推荐码付款后我将得到一定的返比代金卷，可以用来购买阿里云的产品。<br>","content":"<p>观望阿里云很久了，终于在这个春节来了后，一咬牙、一狠心、一跺脚就买下了一台 ECS。不分昼夜的折腾了几天后，终于在几天前配置好了自己期望的使用环境。<br>由于本人初次接触 Linux，配置期间三度初始化磁盘（等价于手机恢复出厂设置），可以说是一步一个坑的走下来的。现趁热打铁对最后一次正确的安装配置做一下总结，给后人乘凉吧。</p><h2 id=\"选择配置\"><a href=\"#选择配置\" class=\"headerlink\" title=\"选择配置\"></a>选择配置</h2><p>作为开发者，选择 Linux 是毋庸置疑的。</p><p>CPU 单核2G，对于我目前来说绝对是够用了。我会用来做什么？当然是瞎折腾了！一台远程服务器就相当于你多了一台24小时不关机的电脑，可以挂点有趣的服务跑着，比如爬虫之类。或者当个代码仓库，用来项目演示。当然，博客也肯定会迁过去的。<br>带宽 2G，不知道带宽提升是不是会影响远程桌面速度。<br>对于 Linux 的诸多版本之间的优劣，我也不甚了解，就选了个耳濡目染较多的 Ubuntu，版本自然是选最新版的64位。<br>Linux 自带 20G 系统盘，另外我又加了一块 100G 云盘，感觉现在还用不了这么大空间。</p><p>以上配置一年的价格是 1200+，我选择的地域是青岛，比国内其他地域相对便宜点。另外付款的时候填写推荐码可以优惠 10%，这是我的推荐码：<strong>rg2j5m</strong>。当然你使用我的推荐码付款后我将得到一定的返比代金卷，可以用来购买阿里云的产品。<br><a id=\"more\"></a></p><h2 id=\"目的\"><a href=\"#目的\" class=\"headerlink\" title=\"目的\"></a>目的</h2><p>本文最终将会配置完成这样一个 Linux 使用环境：</p><ol><li>GNOME 中文图形界面；</li><li>Windows 远程桌面连接；</li><li>Nodejs 安装。</li></ol><h2 id=\"更新软件源\"><a href=\"#更新软件源\" class=\"headerlink\" title=\"更新软件源\"></a>更新软件源</h2><p>不管是从阿里云连接管理终端还是用的 Putty 等 SSH 连接工具，总之你现在应该已经打开一个黑窗口了。<br>开始第一步。</p><pre><code>sudo apt-get update\n</code></pre><p><code>apt-get</code>是一个包管理工具，在 Ubuntu 环境下，会是你以后经常用到的命令之一，类似于 Nodejs 环境下的<code>npm</code>。<br>apt-get 命令一般需要 root 权限执行，所以一般跟着<code>sudo</code>命令。某些情况下，如果你的一个命令运行失败，可以加上<code>sudo</code>命令再尝试下，也许就神奇的成功了。</p><p>Linux 系统基本上分两大类：</p><ol><li>RedHat系列：Redhat、Centos、Fedora等，使用 <code>yum</code>；</li><li>Debian系列：Debian、Ubuntu等，使用 <code>apt-get</code>。</li></ol><p>apt-get 常用命令：</p><ul><li><code>update</code> 更新软件包列表</li><li><code>upgrade</code> 升级软件包</li><li><code>install pkg</code> 安装软件包</li><li><code>remove</code> 移除软件包</li></ul><p>参考：<a href=\"http://www.cnblogs.com/pswzone/archive/2012/04/09/2438885.html\" target=\"_blank\" rel=\"external\">apt-get的更多使用</a></p><blockquote><p>在查找 Linux 相关资料时，尽量带上系统环境与版本，不同版本环境下出现问题的解决办法不一定适用。</p></blockquote><h2 id=\"GNOME-安装\"><a href=\"#GNOME-安装\" class=\"headerlink\" title=\"GNOME 安装\"></a>GNOME 安装</h2><p>安装 x-window 的基础：</p><pre><code>sudo apt-get install x-window-system-core\n</code></pre><p>安装 GNOME 登录管理器：</p><pre><code>sudo apt-get install gdm\n</code></pre><p>安装 Ubuntu 的桌面：</p><pre><code>sudo apt-get install ubuntu-desktop\n</code></pre><p>安装 GNOME 基础软件：</p><pre><code>sudo apt-get install GNOME-core\n</code></pre><p>OK！现在从阿里云连接管理终端登录的话，就可以看到 GNOME 漂亮的登录界面。<br>如果还是黑屏的话，执行<code>startX</code>命令。</p><blockquote><p>startX 即为启动 x-window 服务，适用于任何图形界面的启用。</p></blockquote><p>在 Ubuntu 环境下当然不止 GNOME 一种图形界面，常见的还有 KDE、XFCE 等，从第2个步骤开始对应命令如下：</p><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><div class=\"line\">sudo apt-get install kdm 或 xdm</div><div class=\"line\">sudo apt-get install Kubunut-desktop 或 Xubuntu-desktop</div></pre></td></tr></table></figure><p>我没有使用经验，不知道孰优孰劣，有兴趣，可自行尝试。<br>不过这三种桌面我倒是都安装过，之所以最后选择 GNOME 完全是撞上了，因为我三度初始化磁盘。对，是巧合！<br>从界面美观上看，我更倾向于最后的 GNOME。</p><h2 id=\"设置中文环境\"><a href=\"#设置中文环境\" class=\"headerlink\" title=\"设置中文环境\"></a>设置中文环境</h2><p>这个坑我爬了很久！</p><p>如果你的人品好，请使用最简单的界面设置方式来切换语言环境。</p><ol><li>System Settings -&gt; Language Support 进来会有一个弹出框自动安装语言更新，直接关掉</li><li>Install/Remove Languages… -&gt; Chinese Simplified 勾选 -&gt; Apply Changes</li><li>从上面列表里把汉语拉到第一位，如果可以的话（反正我是怎么都拉不上去）</li><li>选项卡 Text -&gt; 列表里选择汉语 -&gt; Apply System-Wide…</li><li>注销后登录就是汉语了</li></ol><p>而我是使用命令的方式强行设置的。上面的步骤最好先尝试下，我也不确定直接使用命令形式设置能否成功。</p><p>安装中文的支持</p><pre><code>sudo apt-get install language-selector language-env language-pack-zhv\n</code></pre><p>使安装生效，配置区域，看到<code>zh_CN.UTF-8... up-to-date</code>就表示成功了</p><pre><code>dpkg-reconfigure locales \n</code></pre><p>将本地默认语言改为中文</p><pre><code>LC_ALL=zh_CN.UTF-8\n</code></pre><p>配置系统环境</p><pre><code>sudo vi /var/lib/locales/supported.d/zh\n</code></pre><p>加入以下配置参数：</p><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><div class=\"line\">zh_CN.GB18030 GB18030</div><div class=\"line\">zh_CN.GBK GBK</div><div class=\"line\">zh_CN.GB2312 GB2312</div><div class=\"line\">zh_CN.GB18031 GB18031</div><div class=\"line\">zh_HK.BIG5 BIG5</div><div class=\"line\">zh_TW.BIG5 BIG5</div></pre></td></tr></table></figure><p>生成locale（保存在/usr/lib/locale/中）：</p><pre><code>sudo locale-gen\n</code></pre><p>编辑<code>vi /etc/profile</code>：</p><pre><code>export LC_ALL=&quot;zh_CN.GB18030&quot;\n</code></pre><p>编辑<code>vi /etc/default/locale</code>：</p><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><div class=\"line\">#LANG=&quot;zh_CN.UTF-8&quot;</div><div class=\"line\">#LANGUAGE=&quot;zh_CN:zh&quot;</div><div class=\"line\">LC_ALL=&quot;zh_CN.GB18030&quot;</div><div class=\"line\">LANG=&quot;zh_CN.GB18030&quot;</div><div class=\"line\">LANGUAGE=&quot;zh_CN.GB18030:zh_CN.GB2312:zh_CN&quot;</div><div class=\"line\">SUPPORTED=&quot;zh_CN.GB18030:zh_CN:zh:en_US.UTF-8:en_US:en&quot;</div><div class=\"line\">SYSFONT=&quot;lat0-sun16&quot;</div><div class=\"line\">SYSFONTACM=&quot;8859-15&quot;</div></pre></td></tr></table></figure><p>添加个人系统变量，当 GNOME 启动后，会读取这个文件里面的设置：<code>vi ~/.profile</code></p><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><div class=\"line\">export G_FILENAME_ENCODING=GB18030</div><div class=\"line\">export G_BROKEN_FILENAMES=1</div></pre></td></tr></table></figure><p>注销重新登录或重启生效。</p><p>在以上的步骤中用到了<code>vi</code>命令，运行后可以在 shell 环境中编辑文件。著名的 VIM 编辑器就是在 VI 的基础上改进的。<br>以下这些操作可能让你很快上手 VI，比如对路径为<code>/a</code>文件进行编辑。</p><ol><li>执行<code>vi /a</code>打开文件，不存在则创建；</li><li>按键盘编辑功能键<code>insert</code>使文件进入输入模式，现在可对文件进行修改，像使用任意文本编辑器一样；</li><li>按<code>esc</code>退出输入模式，进入指令模式；</li><li>输入<code>:wq!</code>对修改的文件进行保存并退出；</li><li>如果文件没有进行修改，输入<code>:q</code>退出；如果要放弃修改，输入<code>:q!</code>退出。</li></ol><p>参考：<a href=\"http://www.cnblogs.com/88999660/articles/1581524.html\" target=\"_blank\" rel=\"external\">Linux下vi命令大全</a></p><h2 id=\"远程桌面连接\"><a href=\"#远程桌面连接\" class=\"headerlink\" title=\"远程桌面连接\"></a>远程桌面连接</h2><p>阿里云的网页版连接管理终端在图形界面下非常卡，一定让你很不爽。<br>让我们开始有趣的部分吧！</p><p>安装 Xrdp：</p><pre><code>sudo apt-get install xrdp vnc4server xbase-clients\n</code></pre><p>安装 dconf-editor：</p><pre><code>sudo apt-get install dconf-editor\n</code></pre><p>运行 dconf-editor：</p><pre><code>dconf-editor\n</code></pre><p>展开<code>org -&gt; GNOME -&gt; desktop -&gt; remote-access</code>；<br>只打开<code>enabled</code>和<code>notify-on-connect</code>，其他都关掉；<br>修改<code>vnc-password</code>，这是你的远程登录密码；<br>启动远程桌面连接：Windows 上，按<code>win + R</code>运行<code>mstsc</code>；<br>输入你的服务器 IP 和用户名连接；<br>登陆模式选<code>vnc-any</code>，IP和密码输入连接成功。</p><p>如果你依然觉得卡的话，可以对远程连接做以下配置。</p><ol><li>启动远程桌面连接 -&gt; 显示选项</li><li>显示 -&gt; 颜色可进行降级调整，还可以在显示设置调整远程桌面窗口大小</li><li>体验 -&gt; 进行连接和功能的降级调整</li></ol><p>这些调整需要结合服务器配置和网络条件进行合理的选择。</p><p>另外还有一种基于 XFCE 桌面环境的连接方式，这在我第一回合就尝试过，也是可行的。<br>参考：<a href=\"http://jingyan.baidu.com/article/8ebacdf0cdc64949f75cd555.html\" target=\"_blank\" rel=\"external\">Windows 7远程桌面连接Ubuntu 14.04</a></p><h2 id=\"Nodejs-安装\"><a href=\"#Nodejs-安装\" class=\"headerlink\" title=\"Nodejs 安装\"></a>Nodejs 安装</h2><p>Nodejs 的安装有很多种，最简单的就是在服务器浏览器里面从 Nodejs 网站中选择对应版本下载，其次还可以下载源码编译以及从软件中心(apt-get)安装等。</p><p>我这里使用的是 NVM 安装，它是一个 Node 版本管理器。</p><p>安装 Git：</p><pre><code>sudo apt-get install git\n</code></pre><p>安装 NVM：</p><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><div class=\"line\">cd ~/安装路径</div><div class=\"line\">git clone https://github.com/creationix/nvm.git</div></pre></td></tr></table></figure><p>设置 NVM 下载源为淘宝镜像：</p><pre><code>NVM_NODEJS_ORG_MIRROR=https://npm.taobao.org/dist nvm install 0.11.11\n</code></pre><p>配置 NVVM 的相关环境变量，编辑<code>~/.bashrc</code>：</p><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><div class=\"line\">source ~/git/nvm/nvm.sh</div><div class=\"line\">export NVM_NODEJS_ORG_MIRROR=https://npm.taobao.org/dist</div></pre></td></tr></table></figure><p>安装 Nodejs，<code>nvm install version</code>：</p><pre><code>nvm install v4.2.4\n</code></pre><p>同时可以安装下<code>cnpm</code>，从淘宝镜像安装模块：</p><pre><code>npm install -g cnpm --registry=https://registry.npm.taobao.org\n</code></pre><p>开始进行服务器连接测试，以下不是必须要做的。</p><p>安装 Express 生成器：</p><pre><code>cnpm install express-generator -g\n</code></pre><p>生成测试应用：</p><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><div class=\"line\">cd ~/demo</div><div class=\"line\">express test</div></pre></td></tr></table></figure><p>安装所有依赖包：</p><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><div class=\"line\">cd test</div><div class=\"line\">cnpm install</div></pre></td></tr></table></figure><p>启动测试应用：</p><pre><code>npm start\n</code></pre><p>从本地打开<code>http://服务器IP:3000</code>可以看到 <strong>Welcome to Express</strong>，就证明服务器连接成功。</p><h2 id=\"感谢\"><a href=\"#感谢\" class=\"headerlink\" title=\"感谢\"></a>感谢</h2><ul><li><a href=\"http://blog.csdn.net/sunnylgz/article/details/40779973\" target=\"_blank\" rel=\"external\">Windows使用VNC viewer访问Ubuntu 14.04远程桌面的简单方法</a></li><li><a href=\"http://www.cnblogs.com/huangfenghit/archive/2011/05/08/2040201.html\" target=\"_blank\" rel=\"external\">http://www.cnblogs.com/huangfenghit/archive/2011/05/08/2040201.html</a></li><li><a href=\"https://cnodejs.org/topic/5338c5db7cbade005b023c98\" target=\"_blank\" rel=\"external\">快速搭建 Node.js 开发环境以及加速 npm快速搭建 Node.js 开发环境以及加速 npm</a></li></ul><p>当然，实际参考的文章远比这多的多。不过，是这几篇文章在重要的阶段带我登上云端。<br>遗憾的是安装过程中没有截图，只是凭记忆把这些东西串连起来了，实际操作中难免有误，见谅！</p>","categories":[],"tags":[{"name":"Nodejs","path":"api/tags/Nodejs.json"},{"name":"Linux","path":"api/tags/Linux.json"},{"name":"Ubuntu","path":"api/tags/Ubuntu.json"}]}